generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @map("_id") @default(auto()) @db.ObjectId
  username  String   @unique
  email     String   @unique
  password  String
  fullName  String
  avatarUrl String?

  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  posts     Post[]

  @@map("users") // ตั้งชื่อ collection
}

model Post {
  id              String   @id @map("_id") @default(auto()) @db.ObjectId
  title           String
  slug            String   @unique
  excerpt         String?
  content         String
  status          String
  postType        String
  authorId        String   @db.ObjectId
  thumbnail       String?
  author          User     @relation(fields: [authorId], references: [id])
  categoryId      String   @db.ObjectId
  category        Category @relation(fields: [categoryId], references: [id])
  isFeatured      Boolean  @default(false)
  publishedAt     DateTime?
  scheduledAt     DateTime?
  metaTitle       String?
  metaDescription String?
  metaKeyword     String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("posts")
}

model Category {
  id          String  @id @map("_id") @default(auto()) @db.ObjectId
  name        String  @unique
  slug        String  @unique
  description String?
  posts       Post[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("categories")
}

model Menu {
  id    String      @id @map("_id") @default(auto()) @db.ObjectId
  name  String
  items MenuItem[]

  @@map("menus")
}

model MenuItem {
  id       String      @id @map("_id") @default(auto()) @db.ObjectId
  menu     Menu        @relation(fields: [menuId], references: [id])
  menuId   String      @db.ObjectId
  parentId String?     @db.ObjectId
  parent   MenuItem?   @relation("SubMenuItems", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children MenuItem[]  @relation("SubMenuItems")

  name      String
  url       String
  sortOrder Int

  @@map("menu_items")
}

